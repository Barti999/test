document.addEventListener('DOMContentLoaded', function () {
    const mpsList = document.getElementById('mps-list');

    // Sprawdź, czy kontener istnieje
    if (!mpsList) {
        console.error('Element #mps-list nie został znaleziony.');
        return;
    }

    // Endpoint API do pobrania listy posłów
    const apiUrl = 'https://api.sejm.gov.pl/sejm/term10/MP';

    // Pobieranie i wyświetlanie listy posłów
    fetch(apiUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('Błąd sieciowy: ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            console.log('Dane z API:', data); // Logowanie danych do konsoli

            // Sprawdź, czy dane są dostępne
            if (!data || data.length === 0) {
                mpsList.innerHTML = `<p class="error">Brak danych o posłach.</p>`;
                return;
            }

            // Wyczyść kontener przed dodaniem nowych danych
            mpsList.innerHTML = '';

            // Przetwarzanie i wyświetlanie danych
            data.forEach(mp => {
                const mpElement = document.createElement('div');
                mpElement.classList.add('mp-item');

                // Dodaj podstawowe informacje o posłach
                mpElement.innerHTML = `
                    <h3>${mp.firstLastName || 'Brak danych'}</h3>
                    <p><strong>Klub/koło:</strong> ${mp.club || 'Brak danych'}</p>
                    <p><strong>Okręg wyborczy:</strong> ${mp.districtNum || 'Brak danych'} (${mp.districtName || 'Brak danych'})</p>
                    <p><strong>Email:</strong> ${mp.email || 'Brak danych'}</p>
                    <p><strong>Data urodzenia:</strong> ${mp.birthDate || 'Brak danych'}</p>
                    <p><strong>Zawód:</strong> ${mp.profession || 'Brak danych'}</p>
                    <hr>
                `;

                mpsList.appendChild(mpElement);
            });
        })
        .catch(error => {
            console.error('Błąd podczas pobierania danych posłów:', error);
            mpsList.innerHTML = `<p class="error">Nie udało się załadować danych posłów. Spróbuj ponownie później.</p>`;
        });
});