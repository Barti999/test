// Funkcja pobierająca listę posłów
async function fetchMpList() {
    const url = 'https://api.sejm.gov.pl/sejm/term10/MP';
    try {
        const response = await fetch(url);
        const data = await response.json();
        return data;
    } catch (error) {
        console.error("Błąd podczas pobierania listy posłów:", error);
    }
}

// Funkcja wyświetlająca listę posłów
async function displayMpList() {
    const mpList = await fetchMpList();
    const mpListContainer = document.getElementById('mpListItems');

    if (mpList && mpList.length > 0) {
        let html = '';
        mpList.forEach(mp => {
            html += `
                <li>
                    <strong>${mp.firstLastName}</strong> (ID: ${mp.id})<br>
                    Partia: ${mp.club}<br>
                    <button onclick="displayVotes(${mp.id})">Pokaż głosowania</button>
                </li>
            `;
        });
        mpListContainer.innerHTML = html;
    } else {
        mpListContainer.innerHTML = '<li>Brak danych o posłach.</li>';
    }
}

// Funkcja pobierająca dane o głosowaniach posła
async function fetchVotes(mpId) {
    const url = `https://api.sejm.gov.pl/sejm/term9/MP/${mpId}/votes`;
    try {
        const response = await fetch(url);
        const data = await response.json();
        return data;
    } catch (error) {
        console.error("Błąd podczas pobierania danych:", error);
    }
}

// Funkcja wyświetlająca głosowania
async function displayVotes(mpId) {
    const votes = await fetchVotes(mpId);
    const votesContainer = document.getElementById('votes');

    if (votes && votes.length > 0) {
        let html = '<h2>Głosowania posła:</h2>';
        votes.forEach(vote => {
            html += `
                <div class="vote">
                    <p><strong>Data:</strong> ${vote.date}</p>
                    <p><strong>Temat:</strong> ${vote.title}</p>
                    <p><strong>Wynik:</strong> ${vote.vote}</p>
                </div>
            `;
        });
        votesContainer.innerHTML = html;
    } else {
        votesContainer.innerHTML = '<p>Brak danych o głosowaniach.</p>';
    }
}

// Wywołaj funkcję wyświetlającą listę posłów po załadowaniu strony
window.onload = displayMpList;